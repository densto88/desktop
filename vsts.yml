phases:
  - phase: Windows
    queue: Perf Pool - Windows
    steps:
      - task: PowerShell@2
        inputs:
          targetType: 'inline'
          script: |
            Add-MpPreference -ExclusionProcess "devenv.exe"
            Add-MpPreference -ExclusionProcess "msbuild.exe"
            Add-MpPreference -ExclusionProcess "vbcscompiler.exe"
            Add-MpPreference -ExclusionProcess "csc.exe"
            Add-MpPreference -ExclusionProcess "dotnet.exe"
            Add-MpPreference -ExclusionProcess "node.exe"
            Add-MpPreference -ExclusionProcess "node.js"
            Add-MpPreference -ExclusionPath "D:/a"
            Add-MpPreference -ExclusionPath "C:/Users"
      - task: NodeTool@0
        inputs:
          versionSpec: '8.11.1'
      - task: geeklearningio.gl-vsts-tasks-yarn.yarn-installer-task.YarnInstaller@2
        inputs:
          versionSpec: '1.5.1'
      - script: |
          yarn install --force
        name: Install
      - script: |
          yarn lint
        name: Lint
      - script: |
          yarn build:prod
        name: Build
      - script: |
          yarn test:setup && yarn test
        name: Test
